#!/usr/bin/env infinity-env
# DO NOT CHANGE LINE BELOW ----------------------------------------------------
# INFINITY JobType=precycle
# INFINITY ExcludedFiles=storage
# DO NOT CHANGE LINE ABOVE ----------------------------------------------------
# =============================================================================
# dynutil v4.0
# (c) 2013       Petr Kulhanek, kulhanek@chemi.muni.cz
# (c) 2012       Petr Kulhanek, kulhanek@chemi.muni.cz
# (c) 2009       Petr Kulhanek, kulhanek@chemi.muni.cz
# (c) 2005, 2006 Petr Kulhanek, kulhanek@chemi.muni.cz
# =============================================================================
# -----------------------------------------------------------------------------
# precycle-starter - input script for restartable production dynamics
# -----------------------------------------------------------------------------

# WARNING: this type of job supports an automatic job restart of crashed job!!!
#          in the case of failure, please just resubmit a job into queue system
#          without any modification of this script

# input topology --------------------------------------------------------------
# file name without path, this file has to be present in working directory
export PRECYCLE_TOP=""

# input coordinates -----------------------------------------------------------
# file name without path, this file has to be present in working directory
# this file is used only for first production run
export PRECYCLE_CRD=""

# control file for MD it has to be compatible with used MD program ------------
# file name without path, this file has to be presented in working directory
export PRECYCLE_CONTROL="prod.in"

# transform control file (YES/NO) ---------------------------------------------
# if YES then the RANDOM key is substituted by a random key
export PRECYCLE_TRANSFORM_CONTROL="YES"

# index of first production stage ---------------------------------------------
export PRECYCLE_START="1"

# index of final production stage ---------------------------------------------
export PRECYCLE_STOP=""

# storage for data ------------------------------------------------------------
# currently only local storage is supported
# export PRECYCLE_STORAGE="storage"

# compress trajectory file by compressor --------------------------------------
# supported compressors:
#   empty string - no compression
#   gzip
#   bzip2
export PRECYCLE_COMPRESS_TRAJ=""

# number of internal cycles ---------------------------------------------------
export PRECYCLE_ICYCLES="1"

# file name format ------------------------------------------------------------
# it determine the base name of produced files (syntax according to printf)
export PRECYCLE_NAME_FORMAT="prod%03d"

# program to perform MD -------------------------------------------------------
export MD_MODULE="amber:14.0"
export MD_CORE="pmemd"

#------------------------------------------------------------------------------
# THIS IS EXECUTION PART, PLEASE DO NOT CHANGE IT !! ==========================
#------------------------------------------------------------------------------

# do not execute if some parameter is specified
# this is used by INFINITY autodetection plugin

if [ $# -eq 0 ];  then
      module add dynutil-new:${DYNUTIL_ALL_VERSION}
      module add $MD_MODULE
      precycle
fi

